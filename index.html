<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #uploadForm { max-width: 300px; margin: auto; }
        input { width: 100%; padding: 10px; margin: 10px 0; }
        button { padding: 10px; width: 100%; }
        #fileList { margin-top: 20px; }
    </style>
</head>
<body>
    <div id="uploadForm">
        <h2>Upload Your Script</h2>
        <input type="file" id="fileInput" accept=".txt,.lua" required>
        <button id="uploadButton">Upload</button>
    </div>
    <div id="fileList"></div>

    <script>
        const uploadButton = document.getElementById('uploadButton');
        const fileList = document.getElementById('fileList');

        uploadButton.addEventListener('click', async () => {
            const file = document.getElementById('fileInput').files[0];
            if (!file) {
                alert("Please select a file to upload.");
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            // Upload file to File.io
            try {
                const response = await fetch('https://file.io', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                if (data.success) {
                    const link = data.link;
                    displayFileLink(link, file.name);
                    notifyExpiry(link);
                } else {
                    alert("File upload failed: " + data.message);
                }
            } catch (error) {
                console.error('Error uploading file:', error);
            }
        });

        function displayFileLink(link, filename) {
            const fileItem = document.createElement('div');
            fileItem.innerHTML = `<a href="${link}" target="_blank">${filename}</a>`;
            fileList.appendChild(fileItem);
        }

        function notifyExpiry(link) {
            setTimeout(() => {
                alert(`The link ${link} is about to expire. Please download it soon!`);
            }, 1209600000); // Notify after 14 days (in milliseconds)
        }

        // Check for login
        if (!localStorage.getItem('username')) {
            alert('You need to log in first.');
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>
